import{w as Y,v as G,r as l,x as H,z as Ce,P as ae,a3 as ke,D as B,F as $,E as P,j as e,K as k,G as X,H as ie,c as x,B as q,a4 as De,a5 as we,u as Me,a6 as Ne,a7 as Te}from"./index-CoCr-Lwu.js";import{D as We,c as Fe,P as Be}from"./Pagination-CzO8dYpH.js";import{u as Ie,d as Re,a as $e,c as Ae}from"./product.service-Dk86rO-g.js";import{F as _e,a as ze}from"./index-CIMJS-ok.js";import{m as Ee,c as Ue,d as qe,e as te,f as oe,F as Oe,a as Le,b as I}from"./formik.esm-BGeGxEe7.js";import{I as R}from"./Input-CKBMGBQD.js";import{S as Ye}from"./Select-eAE6PZsy.js";import{F as Ge}from"./FIleInput-C9AROsxT.js";import{u as He}from"./useCategoryStore-0YqKzszP.js";import{F as se,M as Xe,B as Ke,a as Je}from"./Menu-BHH0Xlnd.js";import{T as O}from"./Typography-3PLUSMmk.js";import{G as v}from"./Grid-BdMrhXSd.js";import{F as C}from"./TextField-CWhFec2Z.js";import{M as L}from"./MenuItem-Cds6f5lz.js";import{f as Qe}from"./stringUtils-CDJQw5-v.js";import{B as Ze}from"./index-CAApNuAC.js";import{I as Ve}from"./InputAdornment-BUUN-303.js";import{I as et}from"./IconButton-De274572.js";import"./dateUtils-Bv0SVz_X.js";import"./TableRow-vzcb-Cwo.js";import"./useControlled-CQs6qZha.js";import"./createSvgIcon-f0cybHIH.js";import"./Avatar-DKP2U2G5.js";import"./Tooltip-RUjzR2Jp.js";import"./Portal-Db180ur5.js";import"./List-B8z-TvVg.js";import"./useFetch-Ef9WPhKv.js";import"./prepareFormData-CaUafuFc.js";import"./index-BWLtMYHi.js";import"./styled-Dr_zOePF.js";import"./isMuiElement-41k7TQVi.js";import"./listItemIconClasses-C8DadHf-.js";import"./listItemTextClasses-Djdqevzi.js";import"./dividerClasses-QzE5IgDx.js";function tt(t){return G("MuiDialog",t)}const re=Y("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ne=l.createContext({}),rt=P(Ke,{name:"MuiDialog",slot:"Backdrop",overrides:(t,r)=>r.backdrop})({zIndex:-1}),ot=t=>{const{classes:r,scroll:o,maxWidth:i,fullWidth:n,fullScreen:d}=t,u={root:["root"],container:["container",`scroll${k(o)}`],paper:["paper",`paperScroll${k(o)}`,`paperWidth${k(String(i))}`,n&&"paperFullWidth",d&&"paperFullScreen"]};return X(u,tt,r)},st=P(Xe,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),at=P("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.container,r[`scroll${k(o.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),it=P(ae,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.paper,r[`scrollPaper${k(o.scroll)}`],r[`paperWidth${k(String(o.maxWidth))}`],o.fullWidth&&r.paperFullWidth,o.fullScreen&&r.paperFullScreen]}})(ie(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:r})=>!r.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${re.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(r=>r!=="xs").map(r=>({props:{maxWidth:r},style:{maxWidth:`${t.breakpoints.values[r]}${t.breakpoints.unit}`,[`&.${re.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[r]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:r})=>r.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:r})=>r.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${re.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),le=l.forwardRef(function(r,o){const i=H({props:r,name:"MuiDialog"}),n=Ce(),d={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{"aria-describedby":u,"aria-labelledby":p,"aria-modal":m=!0,BackdropComponent:b,BackdropProps:y,children:c,className:s,disableEscapeKeyDown:g=!1,fullScreen:K=!1,fullWidth:D=!1,maxWidth:J="sm",onClick:w,onClose:h,open:M,PaperComponent:Q=ae,PaperProps:S={},scroll:Z="paper",slots:A={},slotProps:_={},TransitionComponent:z=se,transitionDuration:E=d,TransitionProps:U,...V}=i,j={...i,disableEscapeKeyDown:g,fullScreen:K,fullWidth:D,maxWidth:J,scroll:Z},N=ot(j),T=l.useRef(),a=F=>{T.current=F.target===F.currentTarget},f=F=>{w&&w(F),T.current&&(T.current=null,h&&h(F,"backdropClick"))},ee=ke(p),pe=l.useMemo(()=>({titleId:ee}),[ee]),ue={transition:z,...A},me={transition:U,paper:S,backdrop:y,..._},W={slots:ue,slotProps:me},[xe,ge]=B("root",{elementType:st,shouldForwardComponentProp:!0,externalForwardedProps:W,ownerState:j,className:$(N.root,s),ref:o}),[he,fe]=B("backdrop",{elementType:rt,shouldForwardComponentProp:!0,externalForwardedProps:W,ownerState:j}),[be,ye]=B("paper",{elementType:it,shouldForwardComponentProp:!0,externalForwardedProps:W,ownerState:j,className:$(N.paper,S.className)}),[je,Se]=B("container",{elementType:at,externalForwardedProps:W,ownerState:j,className:N.container}),[ve,Pe]=B("transition",{elementType:se,externalForwardedProps:W,ownerState:j,additionalProps:{appear:!0,in:M,timeout:E,role:"presentation"}});return e.jsx(xe,{closeAfterTransition:!0,slots:{backdrop:he},slotProps:{backdrop:{transitionDuration:E,as:b,...fe}},disableEscapeKeyDown:g,onClose:h,open:M,onClick:f,...ge,...V,children:e.jsx(ve,{...Pe,children:e.jsx(je,{onMouseDown:a,...Se,children:e.jsx(be,{as:Q,elevation:24,role:"dialog","aria-describedby":u,"aria-labelledby":ee,"aria-modal":m,...ye,children:e.jsx(ne.Provider,{value:pe,children:c})})})})})});function nt(t){return G("MuiDialogActions",t)}Y("MuiDialogActions",["root","spacing"]);const lt=t=>{const{classes:r,disableSpacing:o}=t;return X({root:["root",!o&&"spacing"]},nt,r)},ct=P("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,!o.disableSpacing&&r.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),ce=l.forwardRef(function(r,o){const i=H({props:r,name:"MuiDialogActions"}),{className:n,disableSpacing:d=!1,...u}=i,p={...i,disableSpacing:d},m=lt(p);return e.jsx(ct,{className:$(m.root,n),ownerState:p,ref:o,...u})});function dt(t){return G("MuiDialogContent",t)}Y("MuiDialogContent",["root","dividers"]);function pt(t){return G("MuiDialogTitle",t)}const ut=Y("MuiDialogTitle",["root"]),mt=t=>{const{classes:r,dividers:o}=t;return X({root:["root",o&&"dividers"]},dt,r)},xt=P("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:o}=t;return[r.root,o.dividers&&r.dividers]}})(ie(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:r})=>r.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:r})=>!r.dividers,style:{[`.${ut.root} + &`]:{paddingTop:0}}}]}))),de=l.forwardRef(function(r,o){const i=H({props:r,name:"MuiDialogContent"}),{className:n,dividers:d=!1,...u}=i,p={...i,dividers:d},m=mt(p);return e.jsx(xt,{className:$(m.root,n),ownerState:p,ref:o,...u})}),gt=t=>{const{classes:r}=t;return X({root:["root"]},pt,r)},ht=P(O,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),ft=l.forwardRef(function(r,o){const i=H({props:r,name:"MuiDialogTitle"}),{className:n,id:d,...u}=i,p=i,m=gt(p),{titleId:b=d}=l.useContext(ne);return e.jsx(ht,{component:"h2",className:$(m.root,n),ownerState:p,ref:o,variant:"h6",id:d??b,...u})}),bt=t=>e.jsx(Ye,{...t,sx:{"&":{borderRadius:"800px",backgroundColor:"var(--color-background-paper-dark)"},...t.sx?.["&"]??{},"& input":{borderRadius:t.size=="small"?"8px":"12px",...t.sx?.["& input"]??{}},"& fieldset":{border:"0.6px solid var(--color-background-paper-light)",transitionProperty:"border-color",transitionDuration:"100ms",borderRadius:t.size=="small"?"8px":"12px",...t.sx?.["& fieldset"]??{}},"&:hover fieldset":{borderColor:"var(--color-foreground-secondary) !important",...t.sx?.["&:hover fieldset"]??{}},"& input:focus ~ fieldset":{border:"0.6px solid var(--color-primary) !important",...t.sx?.["& input:focus ~ fieldset"]??{}},...t.sx??{}}}),yt=Ee(()=>Ue({name:te().required("Product name is required"),description:te().required("Description is required"),price:oe().typeError("Price must be a number").min(0,"Price must be positive").required("Price is required"),stock:oe().typeError("Stock must be a number").min(0,"Stock must be positive").required("Stock is required"),categoryId:te().required("Category is required"),image:qe().nullable()})),jt=yt(),St=({open:t,onClose:r,initialValues:o,onSubmit:i,isSubmitting:n})=>{const{categories:d,fetchCategories:u}=He();l.useEffect(()=>{t&&u()},[u,t]);const p={name:o?.name||"",description:o?.description||"",price:o?.price||0,stock:o?.stock||0,categoryId:o?.category?._id||o?.category?._id||"",image:null};return e.jsxs(le,{open:t,onClose:r,maxWidth:"md",fullWidth:!0,children:[e.jsx(ft,{children:o?._id?"Edit Product":"Add New Product"}),e.jsx(Oe,{initialValues:p,validationSchema:jt,onSubmit:i,enableReinitialize:!0,children:({setFieldValue:m,touched:b,errors:y})=>e.jsxs(Le,{children:[e.jsx(de,{sx:{pt:2},dividers:!0,children:e.jsxs(v,{container:!0,spacing:3,children:[e.jsx(v,{size:{xs:12},children:e.jsxs(x,{className:"grid gap-[13px]",children:[e.jsx(C,{htmlFor:"name",children:"Product Name"}),e.jsx(I,{name:"name",children:({field:c,meta:s})=>e.jsx(R,{...c,id:"name",fullWidth:!0,placeholder:"Enter product name",error:s.touched&&!!s.error,helperText:s.touched&&s.error})})]})}),e.jsx(v,{size:{xs:12},children:e.jsxs(x,{className:"grid gap-[13px]",children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx(I,{name:"description",children:({field:c,meta:s})=>e.jsx(R,{...c,id:"description",fullWidth:!0,multiline:!0,rows:4,placeholder:"Enter product description",error:s.touched&&!!s.error,helperText:s.touched&&s.error})})]})}),e.jsx(v,{size:{xs:12,sm:6},children:e.jsxs(x,{className:"grid gap-[13px]",children:[e.jsx(C,{htmlFor:"price",children:"Price"}),e.jsx(I,{name:"price",children:({field:c,meta:s})=>e.jsx(R,{...c,id:"price",type:"number",fullWidth:!0,placeholder:"0",error:s.touched&&!!s.error,helperText:s.touched&&s.error})})]})}),e.jsx(v,{size:{xs:12,sm:6},children:e.jsxs(x,{className:"grid gap-[13px]",children:[e.jsx(C,{htmlFor:"stock",children:"Stock"}),e.jsx(I,{name:"stock",children:({field:c,meta:s})=>e.jsx(R,{...c,id:"stock",type:"number",fullWidth:!0,placeholder:"0",error:s.touched&&!!s.error,helperText:s.touched&&s.error})})]})}),e.jsx(v,{size:{xs:12},children:e.jsxs(x,{className:"grid gap-[13px]",children:[e.jsx(C,{htmlFor:"categoryId",children:"Category"}),e.jsx(I,{name:"categoryId",children:({field:c,meta:s})=>e.jsxs(bt,{...c,id:"categoryId",fullWidth:!0,error:s.touched&&!!s.error,children:[e.jsx(L,{value:"",disabled:!0,children:"Select Category"}),d.map(g=>e.jsx(L,{value:g._id,children:g.name},g._id))]})}),b.categoryId&&y.categoryId&&e.jsx(x,{className:"text-xs text-red-500 ml-3",children:y.categoryId})]})}),e.jsx(v,{size:{xs:12},children:e.jsxs(x,{className:"grid gap-[13px]",children:[e.jsx(C,{children:"Product Image"}),e.jsx(Ge,{value:o?.imageUrl||null,onChange:c=>m("image",c==="_delete"?null:c),error:b.image&&!!y.image,helperText:b.image&&y.image})]})})]})}),e.jsx(ce,{children:e.jsx(q,{fullWidth:!0,variant:"contained",type:"submit",loading:n,children:"Save Product"})})]})})]})},vt=({open:t,onClose:r,onDelete:o,loading:i,title:n="Delete Product",content:d="Are you sure you want to delete this item? This action cannot be undone."})=>e.jsxs(le,{open:t,onClose:r,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(de,{children:[e.jsx(De,{className:"text-center text-red-700 text-7xl mt-5 mx-auto mb-5"}),e.jsx(O,{variant:"h5",className:"text-center text-text-primary font-bold mb-2",children:n}),e.jsx(O,{variant:"body1",className:"text-text-secondary text-center text-base",children:d})]}),e.jsxs(ce,{children:[e.jsx(q,{variant:"outlined",type:"button",onClick:r,className:"grow basis-0",children:"Cancel"}),e.jsx(q,{variant:"contained",className:"grow basis-0",onClick:o,loading:i,children:"Delete"})]})]}),or=()=>{const[t,r]=l.useState(1),[o,i]=l.useState(!1),[n,d]=l.useState(null),[u,p]=l.useState(!1),[m,b]=l.useState(""),[y,c]=l.useState(null),[s,g]=l.useState(null),[K,D]=l.useState(!1),[J,w]=l.useState(!1),h=we(a=>a.setSnackbar),M=Me(a=>a.user),Q=l.useMemo(()=>({page:t,limit:10,storeId:M?.store?._id.toString(),search:m||void 0}),[t,M?.store?._id,m]),{data:S,loading:Z,fetchData:A}=Ie(Q),_=a=>{d(a||null),i(!0),U()},z=()=>{i(!1),d(null)},E=(a,f)=>{c(a.currentTarget),g(f)},U=()=>{c(null),g(null)},V=()=>{D(!0),c(null)},j=async()=>{if(s){w(!0);try{const{error:a}=await Re(s._id);a?h({type:"failure",message:a.message}):(h({type:"success",message:"Product deleted successfully!"}),D(!1),g(null),A())}catch(a){h({type:"failure",message:a.message||"An error occurred"})}finally{w(!1)}}},N=async a=>{p(!0);try{const{error:f}=n?await $e(n._id,a):await Ae(a);f?h({type:"failure",message:f.message}):(h({type:"success",message:`Product ${n?"updated":"created"} successfully!`}),z(),A())}catch(f){h({type:"failure",message:f.message||"An error occurred"})}finally{p(!1)}},T=Fe({uniqueField:"_id",columns:[{key:"name",label:"Product Name",type:"string"},{key:"price",label:"Price",type:"custom",renderValue:a=>Qe(a)},{key:"stock",label:"Stock",type:"number"},{key:"category.name",label:"Category",type:"string"}]});return e.jsxs(x,{className:"flex flex-col py-12 px-[50px] pb-4",children:[e.jsxs(Je,{anchorEl:y,open:!!y,onClose:U,children:[e.jsx(L,{onClick:()=>_(s),children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(_e,{})," Edit"]})}),e.jsx(L,{onClick:V,sx:{color:"error.main"},children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ze,{})," Delete"]})})]}),e.jsx(vt,{open:K,onClose:()=>D(!1),onDelete:j,loading:J}),e.jsxs(x,{className:"bg-background-paper rounded-[10px] overflow-hidden p-7.5 shadow-[0_5px_20px_0_rgba(0,0,0,0.05)]",children:[e.jsx(O,{variant:"h5",className:"text-foreground-primary mb-5",children:"Product List"}),e.jsxs(x,{className:"flex justify-end items-center gap-4 mb-5",children:[e.jsx(R,{placeholder:"Search",value:m,onChange:a=>b(a.target.value),size:"small",className:"grow basis-0",slotProps:{input:{startAdornment:e.jsx(Ve,{position:"start",children:e.jsx(Ze,{className:"text-[15px]"})})}}}),e.jsx(q,{variant:"contained",startIcon:e.jsx(Ne,{className:"text-xl"}),onClick:()=>_(),children:"Add Product"})]}),e.jsx(We,{rows:S?.data||[],config:T,loading:Z,sortBy:"name",sort:"asc",renderAction:a=>e.jsx(et,{onClick:f=>E(f,a),children:e.jsx(Te,{})})}),e.jsx(x,{className:"mt-5",children:e.jsx(Be,{page:t,lastPage:S?.meta.lastPage||1,onChangePage:a=>r(a),limit:S?.meta.limit||10,total:S?.meta.total||0,onChangeRowsPerPage:()=>{},rowsPerPageOptions:[]})})]}),e.jsx(St,{open:o,onClose:z,initialValues:n,onSubmit:N,isSubmitting:u})]})};export{or as default};
